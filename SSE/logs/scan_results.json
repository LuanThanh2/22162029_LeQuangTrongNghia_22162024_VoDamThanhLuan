{"template-id":"csrf-detection","template-path":"/app/scanner/templates/csrf-detection.yaml","template-encoded":"aWQ6IGNzcmYtZGV0ZWN0aW9uDQppbmZvOg0KICBuYW1lOiBDU1JGIERldGVjdGlvbg0KICBhdXRob3I6IG5naGlhDQogIHNldmVyaXR5OiBtZWRpdW0NCiAgZGVzY3JpcHRpb246IERldGVjdHMgQ3Jvc3MtU2l0ZSBSZXF1ZXN0IEZvcmdlcnkgKENTUkYpIHZ1bG5lcmFiaWxpdGllcyBieSBjaGVja2luZyBmb3IgbWlzc2luZyBDU1JGIHRva2VucyBpbiBzdGF0ZS1jaGFuZ2luZyByZXF1ZXN0cy4NCiAgcmVmZXJlbmNlOg0KICAgIC0gaHR0cHM6Ly9vd2FzcC5vcmcvd3d3LWNvbW11bml0eS9hdHRhY2tzL2NzcmYNCiAgdGFnczogY3NyZiwgc2VjdXJpdHkNCg0KcmVxdWVzdHM6DQogIC0gbWV0aG9kOiBQT1NUDQogICAgcGF0aDoNCiAgICAgIC0gInt7QmFzZVVSTH19L3VwZGF0ZV9wcm9maWxlLnBocCINCiAgICAgIC0gInt7QmFzZVVSTH19L3RyYW5zZmVyX2Z1bmRzLnBocCINCiAgICBoZWFkZXJzOg0KICAgICAgQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQNCiAgICBib2R5OiAiZW1haWw9dGVzdEBleGFtcGxlLmNvbSINCiAgICBtYXRjaGVyczoNCiAgICAgIC0gdHlwZTogc3RhdHVzDQogICAgICAgIHN0YXR1czoNCiAgICAgICAgICAtIDIwMA0KICAgICAgLSB0eXBlOiB3b3JkDQogICAgICAgIHdvcmRzOg0KICAgICAgICAgIC0gIlByb2ZpbGUgdXBkYXRlZCBzdWNjZXNzZnVsbHkiDQogICAgICAgICAgLSAiVHJhbnNmZXIgY29tcGxldGVkIg0KICAgICAgICBwYXJ0OiBib2R5DQogICAgICAgIGNvbmRpdGlvbjogb3INCiAgICAgIC0gdHlwZTogZHNsDQogICAgICAgIGRzbDoNCiAgICAgICAgICAtICIhY29udGFpbnModG9sb3dlcihhbGxfaGVhZGVycyksICd4LWNzcmYtdG9rZW4nKSINCiAgICAgICAgICAtICIhY29udGFpbnModG9sb3dlcihhbGxfaGVhZGVycyksICdjc3JmLXRva2VuJykiDQogICAgICAgIGNvbmRpdGlvbjogYW5kDQo=","info":{"name":"CSRF Detection","author":["nghia"],"tags":["csrf","security"],"description":"Detects Cross-Site Request Forgery (CSRF) vulnerabilities by checking for missing CSRF tokens in state-changing requests.","reference":["https://owasp.org/www-community/attacks/csrf"],"severity":"medium"},"type":"http","host":"testphp.vulnweb.com","port":"80","scheme":"http","url":"http://testphp.vulnweb.com/","path":"/","matched-at":"http://testphp.vulnweb.com/update_profile.php","request":"POST /update_profile.php HTTP/1.1\r\nHost: testphp.vulnweb.com\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 Avira/123.0.0.0\r\nConnection: close\r\nContent-Length: 22\r\nAccept: */*\r\nAccept-Language: en\r\nContent-Type: application/x-www-form-urlencoded\r\nAccept-Encoding: gzip\r\n\r\nemail=test@example.com","response":"HTTP/1.1 404 Not Found\r\nConnection: close\r\nTransfer-Encoding: chunked\r\nContent-Type: text/html; charset=UTF-8\r\nDate: Thu, 29 May 2025 16:33:42 GMT\r\nServer: nginx/1.19.0\r\nX-Powered-By: PHP/5.6.40-38+ubuntu20.04.1+deb.sury.org+1\r\n\r\nFile not found.\n","ip":"44.228.249.3","timestamp":"2025-05-29T16:33:40.063748345Z","curl-command":"curl -X 'POST' -d 'email=test@example.com' -H 'Accept: */*' -H 'Accept-Language: en' -H 'Content-Type: application/x-www-form-urlencoded' -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 Avira/123.0.0.0' 'http://testphp.vulnweb.com/update_profile.php'","matcher-status":true}
{"template-id":"csrf-detection","template-path":"/app/scanner/templates/csrf-detection.yaml","template-encoded":"aWQ6IGNzcmYtZGV0ZWN0aW9uDQppbmZvOg0KICBuYW1lOiBDU1JGIERldGVjdGlvbg0KICBhdXRob3I6IG5naGlhDQogIHNldmVyaXR5OiBtZWRpdW0NCiAgZGVzY3JpcHRpb246IERldGVjdHMgQ3Jvc3MtU2l0ZSBSZXF1ZXN0IEZvcmdlcnkgKENTUkYpIHZ1bG5lcmFiaWxpdGllcyBieSBjaGVja2luZyBmb3IgbWlzc2luZyBDU1JGIHRva2VucyBpbiBzdGF0ZS1jaGFuZ2luZyByZXF1ZXN0cy4NCiAgcmVmZXJlbmNlOg0KICAgIC0gaHR0cHM6Ly9vd2FzcC5vcmcvd3d3LWNvbW11bml0eS9hdHRhY2tzL2NzcmYNCiAgdGFnczogY3NyZiwgc2VjdXJpdHkNCg0KcmVxdWVzdHM6DQogIC0gbWV0aG9kOiBQT1NUDQogICAgcGF0aDoNCiAgICAgIC0gInt7QmFzZVVSTH19L3VwZGF0ZV9wcm9maWxlLnBocCINCiAgICAgIC0gInt7QmFzZVVSTH19L3RyYW5zZmVyX2Z1bmRzLnBocCINCiAgICBoZWFkZXJzOg0KICAgICAgQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQNCiAgICBib2R5OiAiZW1haWw9dGVzdEBleGFtcGxlLmNvbSINCiAgICBtYXRjaGVyczoNCiAgICAgIC0gdHlwZTogc3RhdHVzDQogICAgICAgIHN0YXR1czoNCiAgICAgICAgICAtIDIwMA0KICAgICAgLSB0eXBlOiB3b3JkDQogICAgICAgIHdvcmRzOg0KICAgICAgICAgIC0gIlByb2ZpbGUgdXBkYXRlZCBzdWNjZXNzZnVsbHkiDQogICAgICAgICAgLSAiVHJhbnNmZXIgY29tcGxldGVkIg0KICAgICAgICBwYXJ0OiBib2R5DQogICAgICAgIGNvbmRpdGlvbjogb3INCiAgICAgIC0gdHlwZTogZHNsDQogICAgICAgIGRzbDoNCiAgICAgICAgICAtICIhY29udGFpbnModG9sb3dlcihhbGxfaGVhZGVycyksICd4LWNzcmYtdG9rZW4nKSINCiAgICAgICAgICAtICIhY29udGFpbnModG9sb3dlcihhbGxfaGVhZGVycyksICdjc3JmLXRva2VuJykiDQogICAgICAgIGNvbmRpdGlvbjogYW5kDQo=","info":{"name":"CSRF Detection","author":["nghia"],"tags":["csrf","security"],"description":"Detects Cross-Site Request Forgery (CSRF) vulnerabilities by checking for missing CSRF tokens in state-changing requests.","reference":["https://owasp.org/www-community/attacks/csrf"],"severity":"medium"},"type":"http","host":"testphp.vulnweb.com","port":"80","scheme":"http","url":"http://testphp.vulnweb.com/","path":"/","matched-at":"http://testphp.vulnweb.com/transfer_funds.php","request":"POST /transfer_funds.php HTTP/1.1\r\nHost: testphp.vulnweb.com\r\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.74 Safari/537.36\r\nConnection: close\r\nContent-Length: 22\r\nAccept: */*\r\nAccept-Language: en\r\nContent-Type: application/x-www-form-urlencoded\r\nAccept-Encoding: gzip\r\n\r\nemail=test@example.com","response":"HTTP/1.1 404 Not Found\r\nConnection: close\r\nTransfer-Encoding: chunked\r\nContent-Type: text/html; charset=UTF-8\r\nDate: Thu, 29 May 2025 16:33:42 GMT\r\nServer: nginx/1.19.0\r\nX-Powered-By: PHP/5.6.40-38+ubuntu20.04.1+deb.sury.org+1\r\n\r\nFile not found.\n","ip":"44.228.249.3","timestamp":"2025-05-29T16:33:40.465325452Z","curl-command":"curl -X 'POST' -d 'email=test@example.com' -H 'Accept: */*' -H 'Accept-Language: en' -H 'Content-Type: application/x-www-form-urlencoded' -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.74 Safari/537.36' 'http://testphp.vulnweb.com/transfer_funds.php'","matcher-status":true}
